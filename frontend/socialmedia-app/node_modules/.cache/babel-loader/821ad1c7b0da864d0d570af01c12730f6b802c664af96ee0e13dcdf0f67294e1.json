{"ast":null,"code":"var _jsxFileName = \"H:\\\\SecondProject-DjangoReact\\\\frontend\\\\socialmedia-app\\\\src\\\\pages\\\\EditProfilePage.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { BASE_URL } from '../config';\nimport { showErrorToast } from '../components/ErroToast';\nimport { showSuccessToast } from '../components/CustomToast';\nimport { Link, useNavigate } from 'react-router-dom';\nimport { logout } from '../features/auth/userSlice';\nimport EmojiPicker from 'emoji-picker-react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfilePage = () => {\n  _s();\n  const user = useSelector(state => state.user.user);\n  const token = useSelector(state => state.auth.token);\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const [originalData, setOriginalData] = useState({});\n  const [profileData, setProfileData] = useState({\n    username: '',\n    first_name: '',\n    email: '',\n    bio: '',\n    dob: '',\n    mobile: ''\n  });\n  const [passwordData, setPasswordData] = useState({\n    current_password: '',\n    new_password: '',\n    confirm_password: ''\n  });\n  const [errors, setErrors] = useState({\n    profile: {},\n    password: {}\n  });\n  const [bio, setBio] = useState('');\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\n  const textareaRef = useRef(null);\n  useEffect(() => {\n    const fetchProfile = async () => {\n      try {\n        const response = await axios.get(`${BASE_URL}/api/users/profile/${user === null || user === void 0 ? void 0 : user.id}/`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        setProfileData(response.data);\n        setOriginalData(response.data); // Save original data\n      } catch (err) {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          profile: {\n            message: 'An error occurred while fetching the profile.'\n          }\n        }));\n      }\n    };\n    if (user && token) fetchProfile();\n  }, [user, token]);\n  const handleProfileChange = e => {\n    setProfileData({\n      ...profileData,\n      [e.target.name]: e.target.value\n    });\n  };\n  const handlePasswordChange = e => {\n    setPasswordData({\n      ...passwordData,\n      [e.target.name]: e.target.value\n    });\n  };\n  const validateProfile = () => {\n    const errors = {};\n\n    // Username validation\n    if (!profileData.username.trim()) {\n      errors.username = 'Username cannot be empty or just spaces';\n    }\n\n    // First Name validation\n    if (!profileData.first_name.trim()) {\n      errors.first_name = 'First Name cannot be empty or just spaces';\n    }\n\n    // Date of Birth validation (Age must be 18 or above)\n    const userDob = new Date(profileData.dob);\n    const age = new Date().getFullYear() - userDob.getFullYear();\n    if (!profileData.dob) {\n      errors.dob = 'Date of birth is required';\n    } else if (age < 18) {\n      errors.dob = 'You must be at least 18 years old';\n    }\n\n    // Mobile number validation (Indian format)\n    const mobileRegex = /^[6-9]\\d{9}$/;\n    if (!profileData.mobile) {\n      errors.mobile = 'Mobile number is required';\n    } else if (!mobileRegex.test(profileData.mobile)) {\n      errors.mobile = 'Invalid mobile number';\n    }\n    return errors;\n  };\n  const validatePassword = () => {\n    const errors = {};\n\n    // Current Password validation\n    if (!passwordData.current_password) {\n      errors.current_password = 'Current password is required';\n    }\n\n    // New Password validation (strong password)\n    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\n    if (!passwordData.new_password) {\n      errors.new_password = 'New password is required';\n    } else if (!passwordRegex.test(passwordData.new_password)) {\n      errors.new_password = 'New password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, one number, and one special character';\n    }\n\n    // Confirm password validation\n    if (passwordData.new_password !== passwordData.confirm_password) {\n      errors.confirm_password = 'Passwords do not match';\n    }\n    return errors;\n  };\n  const handleProfileSubmit = async e => {\n    e.preventDefault();\n\n    // Validate profile data\n    const profileErrors = validateProfile();\n    if (Object.keys(profileErrors).length > 0) {\n      setErrors(prevErrors => ({\n        ...prevErrors,\n        profile: profileErrors\n      }));\n      return;\n    }\n\n    // Filter out only changed fields\n    const changedData = Object.keys(profileData).reduce((acc, key) => {\n      if (profileData[key] !== originalData[key]) {\n        acc[key] = profileData[key];\n      }\n      return acc;\n    }, {});\n    if (Object.keys(changedData).length === 0) {\n      showErrorToast('No changes detected.');\n      return;\n    }\n    try {\n      await axios.patch(`${BASE_URL}/api/users/profile/update/`, changedData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      showSuccessToast('Profile updated successfully!');\n      setOriginalData(profileData);\n      setTimeout(() => {\n        navigate('/profile-detail');\n      }, 1000);\n    } catch (err) {\n      var _err$response, _err$response$data;\n      if (((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.detail) === 'Username already exists.') {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          profile: {\n            username: 'Username already exists.'\n          }\n        }));\n      } else {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          profile: {\n            message: 'An error occurred while updating the profile.'\n          }\n        }));\n      }\n    }\n  };\n  const handlePasswordSubmit = async e => {\n    e.preventDefault();\n\n    // Validate password data\n    const passwordErrors = validatePassword();\n    if (Object.keys(passwordErrors).length > 0) {\n      setErrors(prevErrors => ({\n        ...prevErrors,\n        password: passwordErrors\n      }));\n      return;\n    }\n    try {\n      await axios.patch(`${BASE_URL}/api/users/password/update/`, passwordData, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      showSuccessToast('Password updated successfully!Please Login again!');\n      dispatch(logout());\n      setTimeout(() => {\n        navigate('/login');\n      }, 2000);\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      // Handle API error responses\n      if ((_err$response2 = err.response) !== null && _err$response2 !== void 0 && (_err$response2$data = _err$response2.data) !== null && _err$response2$data !== void 0 && _err$response2$data.detail) {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          password: {\n            message: err.response.data.detail\n          }\n        }));\n      } else {\n        setErrors(prevErrors => ({\n          ...prevErrors,\n          password: {\n            message: 'An error occurred while updating the password.'\n          }\n        }));\n      }\n    }\n  };\n  // Handle text area content change\n  const handleBioChange = e => {\n    setBio(e.target.value);\n  };\n\n  // Handle emoji click event to add emoji to textarea\n  const handleEmojiClick = emojiObject => {\n    const cursorPos = textareaRef.current.selectionStart; // Get current cursor position\n    const textBefore = bio.substring(0, cursorPos); // Text before cursor\n    const textAfter = bio.substring(cursorPos); // Text after cursor\n    setBio(textBefore + emojiObject.emoji + textAfter); // Update bio with emoji\n    setShowEmojiPicker(false); // Hide emoji picker after selection\n\n    // Move cursor position after the emoji\n    setTimeout(() => {\n      textareaRef.current.selectionStart = textareaRef.current.selectionEnd = cursorPos + emojiObject.emoji.length;\n      textareaRef.current.focus();\n    }, 0);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"max-w-3xl mx-auto p-6 bg-white shadow-md rounded-md mt-8\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-semibold\",\n        children: \"Edit Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/profile\",\n        className: \"text-blue-500 hover:text-blue-700\",\n        children: \"Back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 7\n    }, this), errors.profile.message && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-red-500 text-center mb-4\",\n      children: errors.profile.message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleProfileSubmit,\n      className: \"mb-8\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Username\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"username\",\n          value: profileData.username,\n          onChange: handleProfileChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), errors.profile.username && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.profile.username\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"First Name\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"first_name\",\n          value: profileData.first_name,\n          onChange: handleProfileChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this), errors.profile.first_name && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.profile.first_name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 273,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"email\",\n          name: \"email\",\n          value: profileData.email,\n          readOnly: true,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 274,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 272,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n          ref: textareaRef,\n          className: \"w-full p-2 border border-gray-300 rounded-md mb-2\",\n          placeholder: \"Write your bio here...\",\n          value: bio,\n          onChange: handleBioChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"absolute top-2 right-2 text-xl text-gray-500 cursor-pointer\",\n          onClick: () => setShowEmojiPicker(!showEmojiPicker),\n          children: /*#__PURE__*/_jsxDEV(FaSmile, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 9\n        }, this), showEmojiPicker && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"absolute z-10 bottom-full right-0\",\n          children: /*#__PURE__*/_jsxDEV(EmojiPicker, {\n            onEmojiClick: handleEmojiClick\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Date of Birth\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"date\",\n          name: \"dob\",\n          value: profileData.dob,\n          onChange: handleProfileChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 325,\n          columnNumber: 11\n        }, this), errors.profile.dob && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.profile.dob\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 333,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 323,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Mobile\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          name: \"mobile\",\n          value: profileData.mobile,\n          onChange: handleProfileChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), errors.profile.mobile && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.profile.mobile\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600\",\n        children: \"Update Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 352,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handlePasswordSubmit,\n      children: [errors.password.message && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-red-500 text-center mb-4\",\n        children: errors.password.message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Current Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 368,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          name: \"current_password\",\n          value: passwordData.current_password,\n          onChange: handlePasswordChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 369,\n          columnNumber: 11\n        }, this), errors.password.current_password && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.password.current_password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 377,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"New Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 383,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          name: \"new_password\",\n          value: passwordData.new_password,\n          onChange: handlePasswordChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this), errors.password.new_password && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.password.new_password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 382,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mb-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          className: \"block text-sm font-medium text-gray-700\",\n          children: \"Confirm New Password\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 398,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          name: \"confirm_password\",\n          value: passwordData.confirm_password,\n          onChange: handlePasswordChange,\n          className: \"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 399,\n          columnNumber: 11\n        }, this), errors.password.confirm_password && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-red-500 text-sm\",\n          children: errors.password.confirm_password\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 407,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600\",\n        children: \"Change Password\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 411,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 227,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfilePage, \"WInsgUW8SqQGknEjQxI2oP5JWjg=\", false, function () {\n  return [useSelector, useSelector, useNavigate, useDispatch];\n});\n_c = EditProfilePage;\nexport default EditProfilePage;\nvar _c;\n$RefreshReg$(_c, \"EditProfilePage\");","map":{"version":3,"names":["React","useState","useEffect","axios","useDispatch","useSelector","BASE_URL","showErrorToast","showSuccessToast","Link","useNavigate","logout","EmojiPicker","jsxDEV","_jsxDEV","EditProfilePage","_s","user","state","token","auth","navigate","dispatch","originalData","setOriginalData","profileData","setProfileData","username","first_name","email","bio","dob","mobile","passwordData","setPasswordData","current_password","new_password","confirm_password","errors","setErrors","profile","password","setBio","showEmojiPicker","setShowEmojiPicker","textareaRef","useRef","fetchProfile","response","get","id","headers","Authorization","data","err","prevErrors","message","handleProfileChange","e","target","name","value","handlePasswordChange","validateProfile","trim","userDob","Date","age","getFullYear","mobileRegex","test","validatePassword","passwordRegex","handleProfileSubmit","preventDefault","profileErrors","Object","keys","length","changedData","reduce","acc","key","patch","setTimeout","_err$response","_err$response$data","detail","handlePasswordSubmit","passwordErrors","_err$response2","_err$response2$data","handleBioChange","handleEmojiClick","emojiObject","cursorPos","current","selectionStart","textBefore","substring","textAfter","emoji","selectionEnd","focus","className","children","fileName","_jsxFileName","lineNumber","columnNumber","to","onSubmit","type","onChange","readOnly","ref","placeholder","onClick","FaSmile","onEmojiClick","_c","$RefreshReg$"],"sources":["H:/SecondProject-DjangoReact/frontend/socialmedia-app/src/pages/EditProfilePage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport { BASE_URL } from '../config';\r\nimport { showErrorToast } from '../components/ErroToast';\r\nimport { showSuccessToast } from '../components/CustomToast';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { logout } from '../features/auth/userSlice';\r\nimport EmojiPicker from 'emoji-picker-react';\r\n\r\nconst EditProfilePage = () => {\r\n  const user = useSelector((state) => state.user.user);\r\n  const token = useSelector((state) => state.auth.token);\r\n  const navigate = useNavigate()\r\n  const dispatch = useDispatch()\r\n  const [originalData, setOriginalData] = useState({});\r\n  const [profileData, setProfileData] = useState({\r\n    username: '',\r\n    first_name: '',\r\n    email: '',\r\n    bio: '',\r\n    dob: '',\r\n    mobile: '',\r\n  });\r\n\r\n  const [passwordData, setPasswordData] = useState({\r\n    current_password: '',\r\n    new_password: '',\r\n    confirm_password: '',\r\n  });\r\n\r\n  const [errors, setErrors] = useState({\r\n    profile: {},\r\n    password: {},\r\n  });\r\n  const [bio, setBio] = useState('');\r\n  const [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n  const textareaRef = useRef(null);\r\n  useEffect(() => {\r\n    const fetchProfile = async () => {\r\n      try {\r\n        const response = await axios.get(`${BASE_URL}/api/users/profile/${user?.id}/`, {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        });\r\n        setProfileData(response.data);\r\n        setOriginalData(response.data); // Save original data\r\n      } catch (err) {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          profile: { message: 'An error occurred while fetching the profile.' },\r\n        }));\r\n      }\r\n    };\r\n\r\n    if (user && token) fetchProfile();\r\n  }, [user, token]);\r\n\r\n  const handleProfileChange = (e) => {\r\n    setProfileData({ ...profileData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handlePasswordChange = (e) => {\r\n    setPasswordData({ ...passwordData, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const validateProfile = () => {\r\n    const errors = {};\r\n\r\n    // Username validation\r\n    if (!profileData.username.trim()) {\r\n      errors.username = 'Username cannot be empty or just spaces';\r\n    }\r\n\r\n    // First Name validation\r\n    if (!profileData.first_name.trim()) {\r\n      errors.first_name = 'First Name cannot be empty or just spaces';\r\n    }\r\n\r\n    // Date of Birth validation (Age must be 18 or above)\r\n    const userDob = new Date(profileData.dob);\r\n    const age = new Date().getFullYear() - userDob.getFullYear();\r\n    if (!profileData.dob) {\r\n      errors.dob = 'Date of birth is required';\r\n    } else if (age < 18) {\r\n      errors.dob = 'You must be at least 18 years old';\r\n    }\r\n\r\n    // Mobile number validation (Indian format)\r\n    const mobileRegex = /^[6-9]\\d{9}$/;\r\n    if (!profileData.mobile) {\r\n      errors.mobile = 'Mobile number is required';\r\n    } else if (!mobileRegex.test(profileData.mobile)) {\r\n      errors.mobile = 'Invalid mobile number';\r\n    }\r\n\r\n    return errors;\r\n  };\r\n\r\n  const validatePassword = () => {\r\n    const errors = {};\r\n\r\n    // Current Password validation\r\n    if (!passwordData.current_password) {\r\n      errors.current_password = 'Current password is required';\r\n    }\r\n\r\n    // New Password validation (strong password)\r\n    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&])[A-Za-z\\d@$!%*?&]{8,}$/;\r\n    if (!passwordData.new_password) {\r\n      errors.new_password = 'New password is required';\r\n    } else if (!passwordRegex.test(passwordData.new_password)) {\r\n      errors.new_password =\r\n        'New password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, one number, and one special character';\r\n    }\r\n\r\n    // Confirm password validation\r\n    if (passwordData.new_password !== passwordData.confirm_password) {\r\n      errors.confirm_password = 'Passwords do not match';\r\n    }\r\n\r\n    return errors;\r\n  };\r\n\r\n  const handleProfileSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Validate profile data\r\n    const profileErrors = validateProfile();\r\n    if (Object.keys(profileErrors).length > 0) {\r\n      setErrors((prevErrors) => ({ ...prevErrors, profile: profileErrors }));\r\n      return;\r\n    }\r\n\r\n    // Filter out only changed fields\r\n    const changedData = Object.keys(profileData).reduce((acc, key) => {\r\n      if (profileData[key] !== originalData[key]) {\r\n        acc[key] = profileData[key];\r\n      }\r\n      return acc;\r\n    }, {});\r\n\r\n    if (Object.keys(changedData).length === 0) {\r\n      showErrorToast('No changes detected.');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.patch(`${BASE_URL}/api/users/profile/update/`, changedData, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n\r\n      showSuccessToast('Profile updated successfully!');\r\n      setOriginalData(profileData);\r\n     \r\n      setTimeout(() => {\r\n        navigate('/profile-detail')\r\n      }, 1000);\r\n    } catch (err) {\r\n      if (err.response?.data?.detail === 'Username already exists.') {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          profile: { username: 'Username already exists.' },\r\n        }));\r\n      } else {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          profile: { message: 'An error occurred while updating the profile.' },\r\n        }));\r\n      }\r\n    }\r\n  };\r\n\r\n  const handlePasswordSubmit = async (e) => {\r\n    e.preventDefault();\r\n\r\n    // Validate password data\r\n    const passwordErrors = validatePassword();\r\n    if (Object.keys(passwordErrors).length > 0) {\r\n      setErrors((prevErrors) => ({ ...prevErrors, password: passwordErrors }));\r\n      return;\r\n    }\r\n\r\n    try {\r\n      await axios.patch(`${BASE_URL}/api/users/password/update/`, passwordData, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      showSuccessToast('Password updated successfully!Please Login again!');\r\n      dispatch(logout())\r\n      setTimeout(() => {\r\n        navigate('/login')\r\n      }, 2000);\r\n    } catch (err) {\r\n      // Handle API error responses\r\n      if (err.response?.data?.detail) {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          password: { message: err.response.data.detail },\r\n        }));\r\n      } else {\r\n        setErrors((prevErrors) => ({\r\n          ...prevErrors,\r\n          password: { message: 'An error occurred while updating the password.' },\r\n        }));\r\n      }\r\n    }\r\n  };\r\n// Handle text area content change\r\nconst handleBioChange = (e) => {\r\n  setBio(e.target.value);\r\n};\r\n\r\n// Handle emoji click event to add emoji to textarea\r\nconst handleEmojiClick = (emojiObject) => {\r\n  const cursorPos = textareaRef.current.selectionStart; // Get current cursor position\r\n  const textBefore = bio.substring(0, cursorPos); // Text before cursor\r\n  const textAfter = bio.substring(cursorPos); // Text after cursor\r\n  setBio(textBefore + emojiObject.emoji + textAfter); // Update bio with emoji\r\n  setShowEmojiPicker(false); // Hide emoji picker after selection\r\n\r\n  // Move cursor position after the emoji\r\n  setTimeout(() => {\r\n    textareaRef.current.selectionStart = textareaRef.current.selectionEnd = cursorPos + emojiObject.emoji.length;\r\n    textareaRef.current.focus();\r\n  }, 0);\r\n};\r\n  return (\r\n    <div className=\"max-w-3xl mx-auto p-6 bg-white shadow-md rounded-md mt-8\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h2 className=\"text-2xl font-semibold\">Edit Profile</h2>\r\n        <Link to=\"/profile\" className=\"text-blue-500 hover:text-blue-700\">\r\n          Back\r\n        </Link>\r\n      </div>\r\n\r\n      {errors.profile.message && (\r\n        <div className=\"text-red-500 text-center mb-4\">{errors.profile.message}</div>\r\n      )}\r\n\r\n      {/* Profile Update Form */}\r\n      <form onSubmit={handleProfileSubmit} className=\"mb-8\">\r\n        {/* Username Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Username</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"username\"\r\n            value={profileData.username}\r\n            onChange={handleProfileChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.profile.username && (\r\n            <div className=\"text-red-500 text-sm\">{errors.profile.username}</div>\r\n          )}\r\n        </div>\r\n\r\n        {/* First Name Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">First Name</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"first_name\"\r\n            value={profileData.first_name}\r\n            onChange={handleProfileChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.profile.first_name && (\r\n            <div className=\"text-red-500 text-sm\">{errors.profile.first_name}</div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Email Field (Read Only) */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Email</label>\r\n          <input\r\n            type=\"email\"\r\n            name=\"email\"\r\n            value={profileData.email}\r\n            readOnly\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md bg-gray-100 cursor-not-allowed\"\r\n          />\r\n        </div>\r\n\r\n        {/* Bio Field */}\r\n        {/* <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Bio</label>\r\n          <textarea\r\n            name=\"bio\"\r\n            value={profileData.bio}\r\n            onChange={handleProfileChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n        </div> */}\r\n          \r\n      {/* Bio Textarea */}\r\n      <div className=\"relative\">\r\n        <textarea\r\n          ref={textareaRef}\r\n          className=\"w-full p-2 border border-gray-300 rounded-md mb-2\"\r\n          placeholder=\"Write your bio here...\"\r\n          value={bio}\r\n          onChange={handleBioChange}\r\n        />\r\n\r\n        {/* Emoji button */}\r\n        <button\r\n          type=\"button\"\r\n          className=\"absolute top-2 right-2 text-xl text-gray-500 cursor-pointer\"\r\n          onClick={() => setShowEmojiPicker(!showEmojiPicker)}\r\n        >\r\n          <FaSmile />\r\n        </button>\r\n\r\n        {/* Show emoji picker */}\r\n        {showEmojiPicker && (\r\n          <div className=\"absolute z-10 bottom-full right-0\">\r\n            <EmojiPicker onEmojiClick={handleEmojiClick} />\r\n          </div>\r\n        )}\r\n      </div>\r\n\r\n\r\n        {/* Date of Birth Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Date of Birth</label>\r\n          <input\r\n            type=\"date\"\r\n            name=\"dob\"\r\n            value={profileData.dob}\r\n            onChange={handleProfileChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.profile.dob && (\r\n            <div className=\"text-red-500 text-sm\">{errors.profile.dob}</div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Mobile Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Mobile</label>\r\n          <input\r\n            type=\"text\"\r\n            name=\"mobile\"\r\n            value={profileData.mobile}\r\n            onChange={handleProfileChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.profile.mobile && (\r\n            <div className=\"text-red-500 text-sm\">{errors.profile.mobile}</div>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600\"\r\n        >\r\n          Update Profile\r\n        </button>\r\n      </form>\r\n\r\n      {/* Password Update Form */}\r\n      <form onSubmit={handlePasswordSubmit}>\r\n        {errors.password.message && (\r\n          <div className=\"text-red-500 text-center mb-4\">{errors.password.message}</div>\r\n        )}\r\n\r\n        {/* Current Password Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Current Password</label>\r\n          <input\r\n            type=\"password\"\r\n            name=\"current_password\"\r\n            value={passwordData.current_password}\r\n            onChange={handlePasswordChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.password.current_password && (\r\n            <div className=\"text-red-500 text-sm\">{errors.password.current_password}</div>\r\n          )}\r\n        </div>\r\n\r\n        {/* New Password Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">New Password</label>\r\n          <input\r\n            type=\"password\"\r\n            name=\"new_password\"\r\n            value={passwordData.new_password}\r\n            onChange={handlePasswordChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.password.new_password && (\r\n            <div className=\"text-red-500 text-sm\">{errors.password.new_password}</div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Confirm Password Field */}\r\n        <div className=\"mb-4\">\r\n          <label className=\"block text-sm font-medium text-gray-700\">Confirm New Password</label>\r\n          <input\r\n            type=\"password\"\r\n            name=\"confirm_password\"\r\n            value={passwordData.confirm_password}\r\n            onChange={handlePasswordChange}\r\n            className=\"mt-1 p-2 block w-full border border-gray-300 rounded-md\"\r\n          />\r\n          {errors.password.confirm_password && (\r\n            <div className=\"text-red-500 text-sm\">{errors.password.confirm_password}</div>\r\n          )}\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          className=\"px-4 py-2 bg-blue-500 text-white font-semibold rounded-md hover:bg-blue-600\"\r\n        >\r\n          Change Password\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EditProfilePage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}