{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useDispatch, useSelector } from \"react-redux\";\nimport connectWebSocket from \"./websocket\";\nimport { updatePostComments, updatePostLikes } from \"./features/auth/feedSlice\";\nexport const handleWebSocketConnection = () => {\n  _s();\n  const dispatch = useDispatch();\n  const token = useSelector(state => state.auth.token);\n  const ws = connectWebSocket(token);\n  ws.onmessage = event => {\n    const data = JSON.parse(event.data);\n    if (data.type === 'LIKE_UPDATE') {\n      dispatch(updatePostLikes({\n        postId: data.postId,\n        likes: data.likes,\n        totalLikes: data.totalLikes\n      }));\n    } else if (data.type === 'COMMENT_UPDATE') {\n      dispatch(updatePostComments({\n        postId: data.postId,\n        comments: data.comments,\n        totalComments: data.totalComments\n      }));\n    }\n  };\n  ws.onclose = () => {\n    console.log('WebSocket connection closed');\n  };\n  ws.onerror = error => {\n    console.log('WebSocket error:', error);\n  };\n};\n_s(handleWebSocketConnection, \"gp616CiZsT7PnlYIR+ywftyOqD0=\", false, function () {\n  return [useDispatch, useSelector];\n});","map":{"version":3,"names":["useDispatch","useSelector","connectWebSocket","updatePostComments","updatePostLikes","handleWebSocketConnection","_s","dispatch","token","state","auth","ws","onmessage","event","data","JSON","parse","type","postId","likes","totalLikes","comments","totalComments","onclose","console","log","onerror","error"],"sources":["H:/SecondProject-DjangoReact/frontend/socialmedia-app/src/handleWebSocket.js"],"sourcesContent":["import { useDispatch, useSelector } from \"react-redux\";\r\nimport connectWebSocket from \"./websocket\";\r\nimport { updatePostComments, updatePostLikes } from \"./features/auth/feedSlice\";\r\n\r\nexport const  handleWebSocketConnection = () => {\r\n\r\n    const dispatch  = useDispatch()\r\n    const token = useSelector((state) => state.auth.token);\r\n    const ws = connectWebSocket(token);\r\n    ws.onmessage = (event) => {\r\n      const data = JSON.parse(event.data);\r\n      if (data.type === 'LIKE_UPDATE') {\r\n        dispatch(updatePostLikes({\r\n          postId: data.postId,\r\n          likes: data.likes,\r\n          totalLikes: data.totalLikes,\r\n        }));\r\n      } else if (data.type === 'COMMENT_UPDATE') {\r\n        dispatch(updatePostComments({\r\n          postId: data.postId,\r\n          comments: data.comments,\r\n          totalComments: data.totalComments,\r\n        }));\r\n      }\r\n    };\r\n    ws.onclose = () => {\r\n      console.log('WebSocket connection closed');\r\n    };\r\n    ws.onerror = (error) => {\r\n      console.log('WebSocket error:', error);\r\n    };\r\n  };"],"mappings":";AAAA,SAASA,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,OAAOC,gBAAgB,MAAM,aAAa;AAC1C,SAASC,kBAAkB,EAAEC,eAAe,QAAQ,2BAA2B;AAE/E,OAAO,MAAOC,yBAAyB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAE5C,MAAMC,QAAQ,GAAIP,WAAW,CAAC,CAAC;EAC/B,MAAMQ,KAAK,GAAGP,WAAW,CAAEQ,KAAK,IAAKA,KAAK,CAACC,IAAI,CAACF,KAAK,CAAC;EACtD,MAAMG,EAAE,GAAGT,gBAAgB,CAACM,KAAK,CAAC;EAClCG,EAAE,CAACC,SAAS,GAAIC,KAAK,IAAK;IACxB,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;IACnC,IAAIA,IAAI,CAACG,IAAI,KAAK,aAAa,EAAE;MAC/BV,QAAQ,CAACH,eAAe,CAAC;QACvBc,MAAM,EAAEJ,IAAI,CAACI,MAAM;QACnBC,KAAK,EAAEL,IAAI,CAACK,KAAK;QACjBC,UAAU,EAAEN,IAAI,CAACM;MACnB,CAAC,CAAC,CAAC;IACL,CAAC,MAAM,IAAIN,IAAI,CAACG,IAAI,KAAK,gBAAgB,EAAE;MACzCV,QAAQ,CAACJ,kBAAkB,CAAC;QAC1Be,MAAM,EAAEJ,IAAI,CAACI,MAAM;QACnBG,QAAQ,EAAEP,IAAI,CAACO,QAAQ;QACvBC,aAAa,EAAER,IAAI,CAACQ;MACtB,CAAC,CAAC,CAAC;IACL;EACF,CAAC;EACDX,EAAE,CAACY,OAAO,GAAG,MAAM;IACjBC,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAC;EAC5C,CAAC;EACDd,EAAE,CAACe,OAAO,GAAIC,KAAK,IAAK;IACtBH,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEE,KAAK,CAAC;EACxC,CAAC;AACH,CAAC;AAACrB,EAAA,CA3BUD,yBAAyB;EAAA,QAEjBL,WAAW,EACfC,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}