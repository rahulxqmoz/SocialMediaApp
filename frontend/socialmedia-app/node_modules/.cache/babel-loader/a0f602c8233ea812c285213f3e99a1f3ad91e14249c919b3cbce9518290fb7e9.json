{"ast":null,"code":"var _jsxFileName = \"H:\\\\SecondProject-DjangoReact\\\\frontend\\\\socialmedia-app\\\\src\\\\components\\\\VideoTrimmer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef } from 'react';\nimport { FFmpeg } from '@ffmpeg/ffmpeg';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoTrimmer = ({\n  videoUrl,\n  videoDuration,\n  onSave,\n  onClose\n}) => {\n  _s();\n  const [startTime, setStartTime] = useState(0);\n  const [endTime, setEndTime] = useState(videoDuration);\n  const [trimmedVideo, setTrimmedVideo] = useState(null);\n  const videoRef = useRef(null);\n  const rangeRef = useRef(null);\n  const ffmpegRef = useRef(null);\n  const fetchFile = async url => {\n    const response = await fetch(url);\n    const blob = await response.blob();\n    return new File([blob], 'video.mp4', {\n      type: 'video/mp4'\n    });\n  };\n  const handleTrim = async () => {\n    if (!ffmpegRef.current) {\n      ffmpegRef.current = new FFmpeg({\n        corePath: \"https://gw.alipayobjects.com/os/lib/ffmpeg/core/0.10.0/dist/ffmpeg-core.js\"\n      });\n    }\n    const ffmpeg = ffmpegRef.current;\n    const videoFile = await fetchFile(videoUrl);\n    const inputBuffer = await videoFile.arrayBuffer();\n    await ffmpeg.load(inputBuffer, 'input.mp4');\n    const outputOptions = ['-i', 'input.mp4',\n    // input file\n    '-ss', `${startTime}`,\n    // start time\n    '-t', `${endTime - startTime}`,\n    // duration\n    'output.mp4' // output file\n    ];\n    try {\n      await ffmpeg.run(outputOptions);\n      const outputBuffer = await ffmpeg.read('output.mp4');\n      const reader = new FileReader();\n      reader.onload = () => {\n        const trimmedVideoFile = new File([new Uint8Array(reader.result)], 'trimmed_video.mp4', {\n          type: 'video/mp4'\n        });\n        const trimmedVideoUrl = URL.createObjectURL(trimmedVideoFile);\n        setTrimmedVideo(trimmedVideoUrl);\n      };\n      reader.readAsArrayBuffer(outputBuffer);\n    } catch (error) {\n      console.error('Error trimming video:', error);\n    } finally {\n      ffmpeg.terminate(); // Clean up resources (optional)\n    }\n  };\n  const handleRangeChange = e => {\n    const rangeValue = e.target.value;\n    const startTime = rangeValue / 100 * videoDuration;\n    const endTime = startTime + 60; // Trim to 1 minute\n    setStartTime(startTime);\n    setEndTime(endTime);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      src: videoUrl,\n      controls: true,\n      width: \"100%\",\n      height: \"100%\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"range\",\n      ref: rangeRef,\n      min: \"0\",\n      max: \"100\",\n      value: startTime / videoDuration * 100,\n      onChange: handleRangeChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: handleTrim,\n      children: \"Trim\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), trimmedVideo && /*#__PURE__*/_jsxDEV(\"video\", {\n      src: trimmedVideo,\n      controls: true,\n      width: \"100%\",\n      height: \"100%\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: onClose,\n      children: \"Close\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => onSave(trimmedVideo),\n      children: \"Save\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 65,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoTrimmer, \"7P24oeWVOvEF30fNkHL5oH27S4w=\");\n_c = VideoTrimmer;\nexport default VideoTrimmer;\nvar _c;\n$RefreshReg$(_c, \"VideoTrimmer\");","map":{"version":3,"names":["React","useState","useRef","FFmpeg","jsxDEV","_jsxDEV","VideoTrimmer","videoUrl","videoDuration","onSave","onClose","_s","startTime","setStartTime","endTime","setEndTime","trimmedVideo","setTrimmedVideo","videoRef","rangeRef","ffmpegRef","fetchFile","url","response","fetch","blob","File","type","handleTrim","current","corePath","ffmpeg","videoFile","inputBuffer","arrayBuffer","load","outputOptions","run","outputBuffer","read","reader","FileReader","onload","trimmedVideoFile","Uint8Array","result","trimmedVideoUrl","URL","createObjectURL","readAsArrayBuffer","error","console","terminate","handleRangeChange","e","rangeValue","target","value","children","ref","src","controls","width","height","fileName","_jsxFileName","lineNumber","columnNumber","min","max","onChange","onClick","_c","$RefreshReg$"],"sources":["H:/SecondProject-DjangoReact/frontend/socialmedia-app/src/components/VideoTrimmer.jsx"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { FFmpeg } from '@ffmpeg/ffmpeg';\r\n\r\n\r\n\r\nconst VideoTrimmer = ({ videoUrl, videoDuration, onSave, onClose }) => {\r\n  const [startTime, setStartTime] = useState(0);\r\n  const [endTime, setEndTime] = useState(videoDuration);\r\n  const [trimmedVideo, setTrimmedVideo] = useState(null);\r\n  const videoRef = useRef(null);\r\n  const rangeRef = useRef(null);\r\n  const ffmpegRef = useRef(null);\r\n\r\n  const fetchFile = async (url) => {\r\n    const response = await fetch(url);\r\n    const blob = await response.blob();\r\n    return new File([blob], 'video.mp4', { type: 'video/mp4' });\r\n  };\r\n  const handleTrim = async () => {\r\n    if (!ffmpegRef.current) {\r\n      ffmpegRef.current = new FFmpeg({\r\n        corePath:  \"https://gw.alipayobjects.com/os/lib/ffmpeg/core/0.10.0/dist/ffmpeg-core.js\",\r\n      });\r\n    }\r\n\r\n    const ffmpeg = ffmpegRef.current;\r\n\r\n    const videoFile = await fetchFile(videoUrl);\r\n    const inputBuffer = await videoFile.arrayBuffer();\r\n    await ffmpeg.load(inputBuffer, 'input.mp4');\r\n\r\n    const outputOptions = [\r\n      '-i', 'input.mp4', // input file\r\n      '-ss', `${startTime}`, // start time\r\n      '-t', `${endTime - startTime}`, // duration\r\n      'output.mp4', // output file\r\n    ];\r\n\r\n    try {\r\n      await ffmpeg.run(outputOptions);\r\n      const outputBuffer = await ffmpeg.read('output.mp4');\r\n      const reader = new FileReader();\r\n      reader.onload = () => {\r\n        const trimmedVideoFile = new File([new Uint8Array(reader.result)], 'trimmed_video.mp4', { type: 'video/mp4' });\r\n        const trimmedVideoUrl = URL.createObjectURL(trimmedVideoFile);\r\n        setTrimmedVideo(trimmedVideoUrl);\r\n      };\r\n      reader.readAsArrayBuffer(outputBuffer);\r\n    } catch (error) {\r\n      console.error('Error trimming video:', error);\r\n    } finally {\r\n      ffmpeg.terminate(); // Clean up resources (optional)\r\n    }\r\n  };\r\n\r\n  const handleRangeChange = (e) => {\r\n    const rangeValue = e.target.value;\r\n    const startTime = rangeValue / 100 * videoDuration;\r\n    const endTime = startTime + 60; // Trim to 1 minute\r\n    setStartTime(startTime);\r\n    setEndTime(endTime);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <video\r\n        ref={videoRef}\r\n        src={videoUrl}\r\n        controls\r\n        width=\"100%\"\r\n        height=\"100%\"\r\n      />\r\n      <input\r\n        type=\"range\"\r\n        ref={rangeRef}\r\n        min=\"0\"\r\n        max=\"100\"\r\n        value={(startTime / videoDuration) * 100}\r\n        onChange={handleRangeChange}\r\n      />\r\n      <button onClick={handleTrim}>Trim</button>\r\n      {trimmedVideo && (\r\n        <video\r\n          src={trimmedVideo}\r\n          controls\r\n          width=\"100%\"\r\n          height=\"100%\"\r\n        />\r\n      )}\r\n      <button onClick={onClose}>Close</button>\r\n      <button onClick={() => onSave(trimmedVideo)}>Save</button>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoTrimmer;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}