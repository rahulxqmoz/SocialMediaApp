{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { BASE_URL } from '../../config';\n\n// Async thunk to fetch profile data\nexport const fetchProfile = createAsyncThunk('profile/fetchProfile', async ({\n  userId,\n  token\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.get(`${BASE_URL}/api/users/profile/${userId}/`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data;\n  } catch (error) {\n    var _error$response, _error$response$data;\n    if (error.response.status === 401) {\n      // Handle unauthorized error\n      return rejectWithValue('Session expired. Please log in again.');\n    }\n    return rejectWithValue(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.detail) || 'Failed to fetch profile.');\n  }\n});\n\n// Async thunk to fetch posts\nexport const fetchPosts = createAsyncThunk('profile/fetchPosts', async ({\n  userId,\n  token\n}, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.get(`${BASE_URL}/api/posts/?user_id=${userId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data;\n  } catch (error) {\n    return rejectWithValue('Failed to fetch posts.');\n  }\n});\n\n// Async thunk to fetch bookmarks\nexport const fetchBookmarks = createAsyncThunk('profile/fetchBookmarks', async (token, {\n  rejectWithValue\n}) => {\n  try {\n    const response = await axios.get(`${BASE_URL}/api/bookmarks`, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data.map(bookmark => bookmark.post);\n  } catch (error) {\n    return rejectWithValue('Failed to fetch bookmarks.');\n  }\n});\n\n// Slice\nconst profileSlice = createSlice({\n  name: 'profile',\n  initialState: {\n    profile: null,\n    posts: [],\n    bookmarks: [],\n    likedPosts: {},\n    comments: {},\n    loading: false,\n    error: null\n  },\n  reducers: {\n    addComment(state, action) {\n      const {\n        postId,\n        comment\n      } = action.payload;\n      state.comments[postId] = [...(state.comments[postId] || []), comment];\n    },\n    updateLikeStatus(state, action) {\n      const {\n        postId,\n        liked\n      } = action.payload;\n      state.likedPosts[postId] = liked;\n    },\n    // Define the missing actions here\n    setPosts(state, action) {\n      state.posts = action.payload;\n    },\n    setLikedPosts(state, action) {\n      state.likedPosts = action.payload;\n    },\n    setBookmarkPosts(state, action) {\n      state.bookmarks = action.payload;\n    },\n    setError(state, action) {\n      state.error = action.payload;\n    },\n    setLoading(state, action) {\n      state.loading = action.payload;\n    }\n  },\n  extraReducers: builder => {\n    builder.addCase(fetchProfile.pending, state => {\n      state.loading = true;\n    }).addCase(fetchProfile.fulfilled, (state, action) => {\n      state.profile = action.payload;\n      state.loading = false;\n    }).addCase(fetchProfile.rejected, (state, action) => {\n      state.error = action.payload;\n      state.loading = false;\n    }).addCase(fetchPosts.pending, state => {\n      state.loading = true;\n    }).addCase(fetchPosts.fulfilled, (state, action) => {\n      // Use setPosts here if you want to manage it through the reducer\n      state.posts = action.payload;\n      state.loading = false;\n    }).addCase(fetchPosts.rejected, (state, action) => {\n      state.error = action.payload;\n      state.loading = false;\n    }).addCase(fetchBookmarks.fulfilled, (state, action) => {\n      // Use setBookmarkPosts here if you want to manage it through the reducer\n      state.bookmarks = action.payload;\n    }).addCase(fetchBookmarks.rejected, (state, action) => {\n      state.error = action.payload;\n    });\n  }\n});\nexport const {\n  addComment,\n  updateLikeStatus,\n  setProfile,\n  setError,\n  setLoading,\n  setLikedPosts,\n  setPosts,\n  setBookmarkPosts\n} = profileSlice.actions;\nexport const profileReducer = profileSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","BASE_URL","fetchProfile","userId","token","rejectWithValue","response","get","headers","Authorization","data","error","_error$response","_error$response$data","status","detail","fetchPosts","fetchBookmarks","map","bookmark","post","profileSlice","name","initialState","profile","posts","bookmarks","likedPosts","comments","loading","reducers","addComment","state","action","postId","comment","payload","updateLikeStatus","liked","setPosts","setLikedPosts","setBookmarkPosts","setError","setLoading","extraReducers","builder","addCase","pending","fulfilled","rejected","setProfile","actions","profileReducer","reducer"],"sources":["H:/SecondProject-DjangoReact/frontend/socialmedia-app/src/features/posts/profileSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { BASE_URL } from '../../config';\r\n\r\n// Async thunk to fetch profile data\r\nexport const fetchProfile = createAsyncThunk(\r\n  'profile/fetchProfile',\r\n  async ({ userId, token }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await axios.get(`${BASE_URL}/api/users/profile/${userId}/`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      if (error.response.status === 401) {\r\n        // Handle unauthorized error\r\n        return rejectWithValue('Session expired. Please log in again.');\r\n      }\r\n      return rejectWithValue(error.response?.data?.detail || 'Failed to fetch profile.');\r\n    }\r\n  }\r\n);\r\n\r\n// Async thunk to fetch posts\r\nexport const fetchPosts = createAsyncThunk(\r\n  'profile/fetchPosts',\r\n  async ({ userId, token }, { rejectWithValue }) => {\r\n    try {\r\n      const response = await axios.get(`${BASE_URL}/api/posts/?user_id=${userId}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      return rejectWithValue('Failed to fetch posts.');\r\n    }\r\n  }\r\n);\r\n\r\n// Async thunk to fetch bookmarks\r\nexport const fetchBookmarks = createAsyncThunk(\r\n  'profile/fetchBookmarks',\r\n  async (token, { rejectWithValue }) => {\r\n    try {\r\n      const response = await axios.get(`${BASE_URL}/api/bookmarks`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      });\r\n      return response.data.map((bookmark) => bookmark.post);\r\n    } catch (error) {\r\n      return rejectWithValue('Failed to fetch bookmarks.');\r\n    }\r\n  }\r\n);\r\n\r\n// Slice\r\nconst profileSlice = createSlice({\r\n  name: 'profile',\r\n  initialState: {\r\n    profile: null,\r\n    posts: [],\r\n    bookmarks: [],\r\n    likedPosts: {},\r\n    comments: {},\r\n    loading: false,\r\n    error: null,\r\n  },\r\n  reducers: {\r\n    addComment(state, action) {\r\n      const { postId, comment } = action.payload;\r\n      state.comments[postId] = [...(state.comments[postId] || []), comment];\r\n    },\r\n    updateLikeStatus(state, action) {\r\n      const { postId, liked } = action.payload;\r\n      state.likedPosts[postId] = liked;\r\n    },\r\n    // Define the missing actions here\r\n    setPosts(state, action) {\r\n      state.posts = action.payload;\r\n    },\r\n    setLikedPosts(state, action) {\r\n      state.likedPosts = action.payload;\r\n    },\r\n    setBookmarkPosts(state, action) {\r\n      state.bookmarks = action.payload;\r\n    },\r\n    setError(state, action) {\r\n      state.error = action.payload;\r\n    },\r\n    setLoading(state, action) {\r\n      state.loading = action.payload;\r\n    },\r\n  },\r\n  extraReducers: (builder) => {\r\n    builder\r\n      .addCase(fetchProfile.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(fetchProfile.fulfilled, (state, action) => {\r\n        state.profile = action.payload;\r\n        state.loading = false;\r\n      })\r\n      .addCase(fetchProfile.rejected, (state, action) => {\r\n        state.error = action.payload;\r\n        state.loading = false;\r\n      })\r\n      .addCase(fetchPosts.pending, (state) => {\r\n        state.loading = true;\r\n      })\r\n      .addCase(fetchPosts.fulfilled, (state, action) => {\r\n        // Use setPosts here if you want to manage it through the reducer\r\n        state.posts = action.payload;\r\n        state.loading = false;\r\n      })\r\n      .addCase(fetchPosts.rejected, (state, action) => {\r\n        state.error = action.payload;\r\n        state.loading = false;\r\n      })\r\n      .addCase(fetchBookmarks.fulfilled, (state, action) => {\r\n        // Use setBookmarkPosts here if you want to manage it through the reducer\r\n        state.bookmarks = action.payload;\r\n      })\r\n      .addCase(fetchBookmarks.rejected, (state, action) => {\r\n        state.error = action.payload;\r\n      });\r\n  },\r\n});\r\n\r\nexport const { addComment, updateLikeStatus ,setProfile,\r\n  setError,\r\n  setLoading,\r\n  setLikedPosts,\r\n  setPosts,\r\n  setBookmarkPosts} = profileSlice.actions;\r\nexport const profileReducer  =profileSlice.reducer;"],"mappings":"AAAA,SAASA,WAAW,EAAEC,gBAAgB,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,QAAQ,QAAQ,cAAc;;AAEvC;AACA,OAAO,MAAMC,YAAY,GAAGH,gBAAgB,CAC1C,sBAAsB,EACtB,OAAO;EAAEI,MAAM;EAAEC;AAAM,CAAC,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAChD,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,GAAG,CAAC,GAAGN,QAAQ,sBAAsBE,MAAM,GAAG,EAAE;MAC3EK,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUL,KAAK;MAChC;IACF,CAAC,CAAC;IACF,OAAOE,QAAQ,CAACI,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IAAA,IAAAC,eAAA,EAAAC,oBAAA;IACd,IAAIF,KAAK,CAACL,QAAQ,CAACQ,MAAM,KAAK,GAAG,EAAE;MACjC;MACA,OAAOT,eAAe,CAAC,uCAAuC,CAAC;IACjE;IACA,OAAOA,eAAe,CAAC,EAAAO,eAAA,GAAAD,KAAK,CAACL,QAAQ,cAAAM,eAAA,wBAAAC,oBAAA,GAAdD,eAAA,CAAgBF,IAAI,cAAAG,oBAAA,uBAApBA,oBAAA,CAAsBE,MAAM,KAAI,0BAA0B,CAAC;EACpF;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMC,UAAU,GAAGjB,gBAAgB,CACxC,oBAAoB,EACpB,OAAO;EAAEI,MAAM;EAAEC;AAAM,CAAC,EAAE;EAAEC;AAAgB,CAAC,KAAK;EAChD,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,GAAG,CAAC,GAAGN,QAAQ,uBAAuBE,MAAM,EAAE,EAAE;MAC3EK,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUL,KAAK;MAChC;IACF,CAAC,CAAC;IACF,OAAOE,QAAQ,CAACI,IAAI;EACtB,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd,OAAON,eAAe,CAAC,wBAAwB,CAAC;EAClD;AACF,CACF,CAAC;;AAED;AACA,OAAO,MAAMY,cAAc,GAAGlB,gBAAgB,CAC5C,wBAAwB,EACxB,OAAOK,KAAK,EAAE;EAAEC;AAAgB,CAAC,KAAK;EACpC,IAAI;IACF,MAAMC,QAAQ,GAAG,MAAMN,KAAK,CAACO,GAAG,CAAC,GAAGN,QAAQ,gBAAgB,EAAE;MAC5DO,OAAO,EAAE;QACPC,aAAa,EAAE,UAAUL,KAAK;MAChC;IACF,CAAC,CAAC;IACF,OAAOE,QAAQ,CAACI,IAAI,CAACQ,GAAG,CAAEC,QAAQ,IAAKA,QAAQ,CAACC,IAAI,CAAC;EACvD,CAAC,CAAC,OAAOT,KAAK,EAAE;IACd,OAAON,eAAe,CAAC,4BAA4B,CAAC;EACtD;AACF,CACF,CAAC;;AAED;AACA,MAAMgB,YAAY,GAAGvB,WAAW,CAAC;EAC/BwB,IAAI,EAAE,SAAS;EACfC,YAAY,EAAE;IACZC,OAAO,EAAE,IAAI;IACbC,KAAK,EAAE,EAAE;IACTC,SAAS,EAAE,EAAE;IACbC,UAAU,EAAE,CAAC,CAAC;IACdC,QAAQ,EAAE,CAAC,CAAC;IACZC,OAAO,EAAE,KAAK;IACdlB,KAAK,EAAE;EACT,CAAC;EACDmB,QAAQ,EAAE;IACRC,UAAUA,CAACC,KAAK,EAAEC,MAAM,EAAE;MACxB,MAAM;QAAEC,MAAM;QAAEC;MAAQ,CAAC,GAAGF,MAAM,CAACG,OAAO;MAC1CJ,KAAK,CAACJ,QAAQ,CAACM,MAAM,CAAC,GAAG,CAAC,IAAIF,KAAK,CAACJ,QAAQ,CAACM,MAAM,CAAC,IAAI,EAAE,CAAC,EAAEC,OAAO,CAAC;IACvE,CAAC;IACDE,gBAAgBA,CAACL,KAAK,EAAEC,MAAM,EAAE;MAC9B,MAAM;QAAEC,MAAM;QAAEI;MAAM,CAAC,GAAGL,MAAM,CAACG,OAAO;MACxCJ,KAAK,CAACL,UAAU,CAACO,MAAM,CAAC,GAAGI,KAAK;IAClC,CAAC;IACD;IACAC,QAAQA,CAACP,KAAK,EAAEC,MAAM,EAAE;MACtBD,KAAK,CAACP,KAAK,GAAGQ,MAAM,CAACG,OAAO;IAC9B,CAAC;IACDI,aAAaA,CAACR,KAAK,EAAEC,MAAM,EAAE;MAC3BD,KAAK,CAACL,UAAU,GAAGM,MAAM,CAACG,OAAO;IACnC,CAAC;IACDK,gBAAgBA,CAACT,KAAK,EAAEC,MAAM,EAAE;MAC9BD,KAAK,CAACN,SAAS,GAAGO,MAAM,CAACG,OAAO;IAClC,CAAC;IACDM,QAAQA,CAACV,KAAK,EAAEC,MAAM,EAAE;MACtBD,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACG,OAAO;IAC9B,CAAC;IACDO,UAAUA,CAACX,KAAK,EAAEC,MAAM,EAAE;MACxBD,KAAK,CAACH,OAAO,GAAGI,MAAM,CAACG,OAAO;IAChC;EACF,CAAC;EACDQ,aAAa,EAAGC,OAAO,IAAK;IAC1BA,OAAO,CACJC,OAAO,CAAC5C,YAAY,CAAC6C,OAAO,EAAGf,KAAK,IAAK;MACxCA,KAAK,CAACH,OAAO,GAAG,IAAI;IACtB,CAAC,CAAC,CACDiB,OAAO,CAAC5C,YAAY,CAAC8C,SAAS,EAAE,CAAChB,KAAK,EAAEC,MAAM,KAAK;MAClDD,KAAK,CAACR,OAAO,GAAGS,MAAM,CAACG,OAAO;MAC9BJ,KAAK,CAACH,OAAO,GAAG,KAAK;IACvB,CAAC,CAAC,CACDiB,OAAO,CAAC5C,YAAY,CAAC+C,QAAQ,EAAE,CAACjB,KAAK,EAAEC,MAAM,KAAK;MACjDD,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACG,OAAO;MAC5BJ,KAAK,CAACH,OAAO,GAAG,KAAK;IACvB,CAAC,CAAC,CACDiB,OAAO,CAAC9B,UAAU,CAAC+B,OAAO,EAAGf,KAAK,IAAK;MACtCA,KAAK,CAACH,OAAO,GAAG,IAAI;IACtB,CAAC,CAAC,CACDiB,OAAO,CAAC9B,UAAU,CAACgC,SAAS,EAAE,CAAChB,KAAK,EAAEC,MAAM,KAAK;MAChD;MACAD,KAAK,CAACP,KAAK,GAAGQ,MAAM,CAACG,OAAO;MAC5BJ,KAAK,CAACH,OAAO,GAAG,KAAK;IACvB,CAAC,CAAC,CACDiB,OAAO,CAAC9B,UAAU,CAACiC,QAAQ,EAAE,CAACjB,KAAK,EAAEC,MAAM,KAAK;MAC/CD,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACG,OAAO;MAC5BJ,KAAK,CAACH,OAAO,GAAG,KAAK;IACvB,CAAC,CAAC,CACDiB,OAAO,CAAC7B,cAAc,CAAC+B,SAAS,EAAE,CAAChB,KAAK,EAAEC,MAAM,KAAK;MACpD;MACAD,KAAK,CAACN,SAAS,GAAGO,MAAM,CAACG,OAAO;IAClC,CAAC,CAAC,CACDU,OAAO,CAAC7B,cAAc,CAACgC,QAAQ,EAAE,CAACjB,KAAK,EAAEC,MAAM,KAAK;MACnDD,KAAK,CAACrB,KAAK,GAAGsB,MAAM,CAACG,OAAO;IAC9B,CAAC,CAAC;EACN;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEL,UAAU;EAAEM,gBAAgB;EAAEa,UAAU;EACrDR,QAAQ;EACRC,UAAU;EACVH,aAAa;EACbD,QAAQ;EACRE;AAAgB,CAAC,GAAGpB,YAAY,CAAC8B,OAAO;AAC1C,OAAO,MAAMC,cAAc,GAAG/B,YAAY,CAACgC,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}